This is Guo Li's code------